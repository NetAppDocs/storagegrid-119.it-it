---
permalink: admin/kms-overview-of-kms-and-appliance-configuration.html 
sidebar: sidebar 
keywords: kms, appliance configuration, node encryption 
summary: 'Prima di poter utilizzare un server di gestione delle chiavi \(KMS\) per proteggere i dati StorageGRID sui nodi dell"appliance, è necessario completare due attività di configurazione: impostare uno o più server KMS e abilitare la crittografia dei nodi per i nodi dell"appliance.  Una volta completate queste due attività di configurazione, il processo di gestione delle chiavi avviene automaticamente.' 
---
= Configurazione KMS e appliance
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Prima di poter utilizzare un server di gestione delle chiavi (KMS) per proteggere i dati StorageGRID sui nodi dell'appliance, è necessario completare due attività di configurazione: impostare uno o più server KMS e abilitare la crittografia dei nodi per i nodi dell'appliance.  Una volta completate queste due attività di configurazione, il processo di gestione delle chiavi avviene automaticamente.

Il diagramma di flusso mostra i passaggi principali per utilizzare un KMS per proteggere i dati StorageGRID sui nodi dell'appliance.

image::../media/kms_configuration_overview.png[Flusso di lavoro di configurazione KMS, descritto nel testo seguente]

Il diagramma di flusso mostra la configurazione di KMS e la configurazione dell'appliance che avvengono in parallelo; tuttavia, è possibile configurare i server di gestione delle chiavi prima o dopo aver abilitato la crittografia dei nodi per i nuovi nodi dell'appliance, in base alle proprie esigenze.



== Configurare il server di gestione delle chiavi (KMS)

La configurazione di un server di gestione delle chiavi comprende i seguenti passaggi generali.

[cols="1a,1a"]
|===
| Fare un passo | Fare riferimento a 


 a| 
Accedi al software KMS e aggiungi un client per StorageGRID a ciascun KMS o cluster KMS.
 a| 
link:kms-configuring-storagegrid-as-client.html["Configurare StorageGRID come client nel KMS"]



 a| 
Ottenere le informazioni richieste per il client StorageGRID sul KMS.
 a| 
link:kms-configuring-storagegrid-as-client.html["Configurare StorageGRID come client nel KMS"]



 a| 
Aggiungere il KMS a Grid Manager, assegnarlo a un singolo sito o a un gruppo predefinito di siti, caricare i certificati richiesti e salvare la configurazione del KMS.
 a| 
link:kms-adding.html["Aggiungere un server di gestione delle chiavi (KMS)"]

|===


== Impostare l'apparecchio

La configurazione di un nodo appliance per l'utilizzo KMS include i seguenti passaggi generali.

. Durante la fase di configurazione hardware dell'installazione dell'appliance, utilizzare StorageGRID Appliance Installer per abilitare l'impostazione *Crittografia nodo* per l'appliance.
+

NOTE: Non è possibile abilitare l'impostazione *Crittografia nodo* dopo aver aggiunto un'appliance alla griglia e non è possibile utilizzare la gestione delle chiavi esterne per le appliance che non hanno la crittografia nodo abilitata.

. Eseguire il programma di installazione dell'appliance StorageGRID .  Durante l'installazione, a ciascun volume dell'appliance viene assegnata una chiave di crittografia dati casuale (DEK), come segue:
+
** Le DEK vengono utilizzate per crittografare i dati su ciascun volume.  Queste chiavi vengono generate utilizzando la crittografia del disco Linux Unified Key Setup (LUKS) nel sistema operativo dell'appliance e non possono essere modificate.
** Ogni singolo DEK è crittografato da una chiave di crittografia a chiave master (KEK).  La KEK iniziale è una chiave temporanea che crittografa le DEK finché l'appliance non riesce a connettersi al KMS.


. Aggiungere il nodo dell'appliance a StorageGRID.


Vedere https://docs.netapp.com/us-en/storagegrid-appliances/installconfig/optional-enabling-node-encryption.html["Abilita la crittografia del nodo"^] per i dettagli.



== Processo di crittografia della gestione delle chiavi (avviene automaticamente)

La crittografia della gestione delle chiavi include i seguenti passaggi di alto livello che vengono eseguiti automaticamente.

. Quando si installa un'appliance con crittografia dei nodi abilitata nella griglia, StorageGRID determina se esiste una configurazione KMS per il sito che contiene il nuovo nodo.
+
** Se per il sito è già stato configurato un KMS, l'appliance riceve la configurazione KMS.
** Se non è ancora stato configurato un KMS per il sito, i dati sull'appliance continuano a essere crittografati dalla KEK temporanea finché non si configura un KMS per il sito e l'appliance non riceve la configurazione KMS.


. L'appliance utilizza la configurazione KMS per connettersi al KMS e richiedere una chiave di crittografia.
. Il KMS invia una chiave di crittografia all'appliance.  La nuova chiave del KMS sostituisce la KEK temporanea e ora viene utilizzata per crittografare e decrittografare le DEK per i volumi dell'appliance.
+

CAUTION: Tutti i dati esistenti prima che il nodo dell'appliance crittografata si connetta al KMS configurato vengono crittografati con una chiave temporanea.  Tuttavia, i volumi dell'appliance non devono essere considerati protetti dalla rimozione dal data center finché la chiave temporanea non viene sostituita dalla chiave di crittografia KMS.

. Se l'appliance viene accesa o riavviata, si riconnette al KMS per richiedere la chiave.  La chiave, che viene salvata nella memoria volatile, non può sopravvivere a un'interruzione di corrente o a un riavvio.

