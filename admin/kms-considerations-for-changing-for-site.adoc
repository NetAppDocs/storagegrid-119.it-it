---
permalink: admin/kms-considerations-for-changing-for-site.html 
sidebar: sidebar 
keywords: kms cluster, copy kms encryption key 
summary: 'Ogni server di gestione delle chiavi \(KMS\) o cluster KMS fornisce una chiave di crittografia a tutti i nodi dell"appliance in un singolo sito o in un gruppo di siti.  Se è necessario modificare il KMS utilizzato per un sito, potrebbe essere necessario copiare la chiave di crittografia da un KMS a un altro.' 
---
= Considerazioni sulla modifica del KMS per un sito
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Ogni server di gestione delle chiavi (KMS) o cluster KMS fornisce una chiave di crittografia a tutti i nodi dell'appliance in un singolo sito o in un gruppo di siti.  Se è necessario modificare il KMS utilizzato per un sito, potrebbe essere necessario copiare la chiave di crittografia da un KMS a un altro.

Se si modifica il KMS utilizzato per un sito, è necessario assicurarsi che i nodi dell'appliance precedentemente crittografati in quel sito possano essere decrittografati utilizzando la chiave memorizzata sul nuovo KMS.  In alcuni casi, potrebbe essere necessario copiare la versione corrente della chiave di crittografia dal KMS originale al nuovo KMS.  È necessario assicurarsi che il KMS disponga della chiave corretta per decrittografare i nodi dell'appliance crittografati nel sito.

Per esempio:

. Inizialmente si configura un KMS predefinito che si applica a tutti i siti che non dispongono di un KMS dedicato.
. Una volta salvato il KMS, tutti i nodi dell'appliance in cui è abilitata l'impostazione *Crittografia nodo* si connettono al KMS e richiedono la chiave di crittografia.  Questa chiave viene utilizzata per crittografare i nodi dell'appliance in tutti i siti.  La stessa chiave deve essere utilizzata anche per decifrare tali apparecchi.
+
image::../media/kms_default_key.png[Chiave predefinita KMS]

. Si decide di aggiungere un KMS specifico per un sito (Data Center 3 nella figura).  Tuttavia, poiché i nodi dell'appliance sono già crittografati, si verifica un errore di convalida quando si tenta di salvare la configurazione per il KMS specifico del sito.  L'errore si verifica perché il KMS specifico del sito non dispone della chiave corretta per decrittografare i nodi in quel sito.
+
image::../media/kms_wrong_key.png[Chiave KMS errata]

. Per risolvere il problema, copiare la versione corrente della chiave di crittografia dal KMS predefinito al nuovo KMS.  (Tecnicamente, si copia la chiave originale in una nuova chiave con lo stesso alias.  (La chiave originale diventa una versione precedente della nuova chiave.)  Il KMS specifico del sito ora dispone della chiave corretta per decrittografare i nodi dell'appliance nel Data Center 3, in modo che possa essere salvata in StorageGRID.
+
image::../media/kms_copied_key.png[Chiave KMS copiata]





== Casi d'uso per modificare il KMS utilizzato per un sito

La tabella riassume i passaggi richiesti nei casi più comuni di modifica del KMS per un sito.

[cols="1a,2a"]
|===
| Caso d'uso per la modifica del KMS di un sito | Passaggi richiesti 


 a| 
Hai una o più voci KMS specifiche del sito e vuoi usarne una come KMS predefinito.
 a| 
Modifica il KMS specifico del sito.  Nel campo *Gestisci chiavi per*, seleziona *Siti non gestiti da un altro KMS (KMS predefinito)*.  Il KMS specifico del sito verrà ora utilizzato come KMS predefinito.  Si applicherà a tutti i siti che non dispongono di un KMS dedicato.

link:kms-editing.html["Modifica un server di gestione delle chiavi (KMS)"]



 a| 
Hai un KMS predefinito e aggiungi un nuovo sito in un'espansione.  Non vuoi utilizzare il KMS predefinito per il nuovo sito.
 a| 
. Se i nodi dell'appliance nel nuovo sito sono già stati crittografati dal KMS predefinito, utilizzare il software KMS per copiare la versione corrente della chiave di crittografia dal KMS predefinito a un nuovo KMS.
. Utilizzando Grid Manager, aggiungi il nuovo KMS e seleziona il sito.


link:kms-adding.html["Aggiungere un server di gestione delle chiavi (KMS)"]



 a| 
Si desidera che il KMS di un sito utilizzi un server diverso.
 a| 
. Se i nodi dell'appliance nel sito sono già stati crittografati dal KMS esistente, utilizzare il software KMS per copiare la versione corrente della chiave di crittografia dal KMS esistente al nuovo KMS.
. Utilizzando Grid Manager, modifica la configurazione KMS esistente e inserisci il nuovo nome host o indirizzo IP.


link:kms-adding.html["Aggiungere un server di gestione delle chiavi (KMS)"]

|===