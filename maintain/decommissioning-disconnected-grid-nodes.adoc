---
permalink: maintain/decommissioning-disconnected-grid-nodes.html 
sidebar: sidebar 
keywords: storagegrid, disconnected nodes, decommission node 
summary: 'Potrebbe essere necessario dismettere un nodo che non è attualmente connesso alla rete (uno il cui stato è sconosciuto o amministrativamente inattivo).' 
---
= Disattivare i nodi della rete disconnessi
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Potrebbe essere necessario dismettere un nodo che al momento non è connesso alla rete (uno il cui stato di integrità è sconosciuto o amministrativamente inattivo).

.Prima di iniziare
* Hai compreso le considerazioni per la dismissionelink:considerations-for-decommissioning-admin-or-gateway-nodes.html["Nodi di amministrazione e gateway"] e le considerazioni per la dismissionelink:considerations-for-decommissioning-storage-nodes.html["Nodi di archiviazione"] .
* Hai ottenuto tutti gli elementi prerequisiti.
* Hai verificato che non ci siano processi di riparazione dati attivi. Vedere link:checking-data-repair-jobs.html["Controlla i lavori di riparazione dei dati"] .
* Hai confermato che il ripristino del nodo di archiviazione non è in corso in nessuna parte della griglia.  In tal caso, è necessario attendere il completamento di qualsiasi ricostruzione di Cassandra eseguita come parte del ripristino.  Si può quindi procedere con la dismissione.
* Hai assicurato che non verranno eseguite altre procedure di manutenzione mentre è in esecuzione la procedura di dismissione del nodo, a meno che la procedura di dismissione del nodo non sia in pausa.
* La colonna *Dismissione possibile* per il nodo o i nodi disconnessi che si desidera dismettere include un segno di spunta verde.
* Hai la passphrase di provisioning.


.Informazioni su questo compito
È possibile identificare i nodi disconnessi cercando l'icona blu Sconosciutoimage:../media/icon_alarm_blue_unknown.png["Icona sconosciuta"] o l'icona grigia Amministrativamente in bassoimage:../media/icon_alarm_gray_administratively_down.png["Icona Amministrativamente inattiva"] nella colonna *Salute*.

Prima di disattivare un nodo disconnesso, tenere presente quanto segue:

* Questa procedura è pensata principalmente per rimuovere un singolo nodo disconnesso.  Se la rete contiene più nodi disconnessi, il software richiede di disattivarli tutti contemporaneamente, aumentando il rischio di risultati imprevisti.
+

CAUTION: Potrebbe verificarsi una perdita di dati se si dismettono più nodi di archiviazione disconnessi contemporaneamente. Vedere link:considerations-for-decommissioning-storage-nodes.html#considerations-disconnected-storage-nodes["Considerazioni sui nodi di archiviazione disconnessi"] .

+

CAUTION: Prestare attenzione quando si dismettono nodi di archiviazione in una griglia contenente nodi basati solo su software.  Se si dismettono tutti i nodi configurati per archiviare sia oggetti che metadati, la possibilità di archiviare oggetti viene rimossa dalla griglia.  Vederelink:../primer/what-storage-node-is.html#types-of-storage-nodes["Tipi di nodi di archiviazione"] per ulteriori informazioni sui nodi di archiviazione solo metadati.

* Se non è possibile rimuovere un nodo disconnesso (ad esempio, un nodo di archiviazione necessario per il quorum ADC), non è possibile rimuovere nessun altro nodo disconnesso.


.Passi
. A meno che non si stia dismettendo un nodo di archivio (che deve essere disconnesso), provare a riportare online i nodi della griglia disconnessi o a recuperarli.
+
Vederelink:warnings-and-considerations-for-grid-node-recovery.html["Procedure di ripristino del nodo della griglia"] per istruzioni.

. Se non è possibile ripristinare un nodo della rete disconnesso e si desidera disattivarlo mentre è disconnesso, selezionare la casella di controllo per quel nodo.
+

NOTE: Se la rete contiene più nodi disconnessi, il software richiede di disattivarli tutti contemporaneamente, aumentando il rischio di risultati imprevisti.

+

CAUTION: Prestare attenzione quando si sceglie di dismettere più di un nodo di rete disconnesso alla volta, soprattutto se si selezionano più nodi di archiviazione disconnessi.  Se hai più di un nodo di archiviazione disconnesso che non riesci a ripristinare, contatta l'assistenza tecnica per determinare la soluzione migliore.

. Immettere la passphrase di provisioning.
+
Il pulsante *Avvia disattivazione* è abilitato.

. Fare clic su *Avvia dismissione*.
+
Viene visualizzato un avviso che indica che è stato selezionato un nodo disconnesso e che i dati dell'oggetto andranno persi se il nodo ha l'unica copia di un oggetto.

. Esaminare l'elenco dei nodi e fare clic su *OK*.
+
Viene avviata la procedura di dismissione e per ogni nodo viene visualizzato lo stato di avanzamento. Durante la procedura viene generato un nuovo pacchetto di ripristino contenente la modifica alla configurazione della griglia.

. Non appena il nuovo Pacchetto di ripristino sarà disponibile, fare clic sul collegamento o selezionare *MANUTENZIONE* > *Sistema* > *Pacchetto di ripristino* per accedere alla pagina Pacchetto di ripristino. Quindi, scarica il `.zip` file.
+
Vedi le istruzioni perlink:downloading-recovery-package.html["scaricando il pacchetto di ripristino"] .

+

NOTE: Scarica il pacchetto di ripristino il prima possibile per assicurarti di poter ripristinare la tua rete se qualcosa va storto durante la procedura di dismissione.

+

CAUTION: Il file del pacchetto di ripristino deve essere protetto perché contiene chiavi di crittografia e password che possono essere utilizzate per ottenere dati dal sistema StorageGRID .

. Monitorare periodicamente la pagina Decommission per assicurarsi che tutti i nodi selezionati vengano dismessi correttamente.
+
La dismissione dei nodi di archiviazione può richiedere giorni o settimane.  Una volta completate tutte le attività, l'elenco di selezione dei nodi viene nuovamente visualizzato con un messaggio di successo.  Se hai dismesso un nodo di archiviazione disconnesso, un messaggio informativo indica che i processi di riparazione sono stati avviati.

. Dopo che i nodi si sono arrestati automaticamente come parte della procedura di dismissione, rimuovere tutte le macchine virtuali rimanenti o altre risorse associate al nodo dismesso.
+

CAUTION: Non eseguire questo passaggio finché i nodi non si saranno spenti automaticamente.

. Se si sta dismettendo un nodo di archiviazione, monitorare lo stato dei processi di riparazione dei *dati replicati* e dei *dati con codice di cancellazione (EC)* che vengono avviati automaticamente durante il processo di dismissione.


[role="tabbed-block"]
====
.Dati replicati
--
* Per ottenere una percentuale stimata di completamento per la riparazione replicata, aggiungere `show-replicated-repair-status` opzione al comando repair-data.
+
`repair-data show-replicated-repair-status`

* Per determinare se le riparazioni sono state completate:
+
.. Selezionare *NODI* > *_Nodo di archiviazione in riparazione_* > *ILM*.
.. Esaminare gli attributi nella sezione Valutazione.  Una volta completate le riparazioni, l'attributo *In attesa - Tutto* indica 0 oggetti.


* Per monitorare la riparazione in modo più dettagliato:
+
.. Selezionare *SUPPORTO* > *Strumenti* > *Topologia griglia*.
.. Selezionare *_grid_* > *_Nodo di archiviazione in riparazione_* > *LDR* > *Data Store*.
.. Utilizzare una combinazione dei seguenti attributi per determinare, nel miglior modo possibile, se le riparazioni replicate sono complete.
+

NOTE: Potrebbero essere presenti incongruenze in Cassandra e le riparazioni non riuscite non vengono tracciate.

+
*** *Riparazioni tentate (XRPA)*: utilizzare questo attributo per monitorare l'avanzamento delle riparazioni replicate.  Questo attributo aumenta ogni volta che un nodo di archiviazione tenta di riparare un oggetto ad alto rischio.  Quando questo attributo non aumenta per un periodo più lungo del periodo di scansione corrente (fornito dall'attributo *Periodo di scansione - Stimato*), significa che la scansione ILM non ha trovato oggetti ad alto rischio che necessitano di riparazione su alcun nodo.
+

NOTE: Gli oggetti ad alto rischio sono oggetti che rischiano di andare completamente persi.  Sono esclusi gli oggetti che non soddisfano la loro configurazione ILM.

*** *Periodo di scansione - Stimato (XSCM)*: utilizzare questo attributo per stimare quando una modifica della policy verrà applicata agli oggetti precedentemente acquisiti.  Se l'attributo *Riparazioni tentate* non aumenta per un periodo più lungo del periodo di scansione corrente, è probabile che siano state eseguite riparazioni replicate.  Si noti che il periodo di scansione può variare.  L'attributo *Periodo di scansione - Stimato (XSCM)* si applica all'intera griglia ed è il massimo di tutti i periodi di scansione dei nodi.  È possibile interrogare la cronologia degli attributi *Periodo di scansione - Stima* per la griglia per determinare un intervallo di tempo appropriato.






--
.Dati con codice di cancellazione (EC)
--
Per monitorare la riparazione dei dati codificati in modo da cancellarli e riprovare eventuali richieste non riuscite:

. Determinare lo stato delle riparazioni dei dati codificati tramite cancellazione:
+
** Selezionare *SUPPORTO* > *Strumenti* > *Metriche* per visualizzare il tempo stimato per il completamento e la percentuale di completamento per il lavoro corrente. Quindi, seleziona *Panoramica EC* nella sezione Grafana. Consulta i dashboard *Tempo stimato per il completamento del lavoro EC in griglia* e *Percentuale completata del lavoro EC in griglia*.
** Utilizzare questo comando per visualizzare lo stato di uno specifico `repair-data` operazione:
+
`repair-data show-ec-repair-status --repair-id repair ID`

** Utilizzare questo comando per elencare tutte le riparazioni:
+
`repair-data show-ec-repair-status`

+
L'output elenca le informazioni, tra cui `repair ID` , per tutte le riparazioni eseguite in precedenza e attualmente.



. Se l'output mostra che l'operazione di riparazione non è riuscita, utilizzare `--repair-id` opzione per riprovare la riparazione.
+
Questo comando riprova una riparazione del nodo non riuscita, utilizzando l'ID di riparazione 6949309319275667690:

+
`repair-data start-ec-node-repair --repair-id 6949309319275667690`

+
Questo comando riprova una riparazione del volume non riuscita, utilizzando l'ID di riparazione 6949309319275667690:

+
`repair-data start-ec-volume-repair --repair-id 6949309319275667690`



--
====
.Dopo aver finito
Non appena i nodi disconnessi sono stati dismessi e tutti i lavori di riparazione dei dati sono stati completati, è possibile dismettere tutti i nodi della griglia connessi, se necessario.

Dopo aver completato la procedura di dismissione, completa questi passaggi:

* Assicurarsi che le unità del nodo di rete dismesso siano state cancellate.  Utilizzare uno strumento o un servizio di cancellazione dati disponibile in commercio per rimuovere in modo permanente e sicuro i dati dalle unità.
* Se hai dismesso un nodo dell'appliance e i dati sull'appliance erano protetti tramite crittografia del nodo, usa StorageGRID Appliance Installer per cancellare la configurazione del server di gestione delle chiavi (Clear KMS).  Se si desidera aggiungere l'appliance a un'altra griglia, è necessario cancellare la configurazione KMS. Per le istruzioni, vedere https://docs.netapp.com/us-en/storagegrid-appliances/commonhardware/monitoring-node-encryption-in-maintenance-mode.html["Monitora la crittografia del nodo in modalità di manutenzione"^] .

